/*! forger 24-03-2014 */
/*!	The MIT License (MIT)

	Copyright (c) 2014 Bear & Owl

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in all
	copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.
*/
"document"in self&&!("classList"in document.createElement("_"))&&!function(a){"use strict";if("Element"in a){var b="classList",c="prototype",d=a.Element[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(""===b)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return g.call(a,b)},j=function(a){for(var b=f.call(a.getAttribute("class")||""),c=b?b.split(/\s+/):[],d=0,e=c.length;e>d;d++)this.push(c[d]);this._updateClassName=function(){a.setAttribute("class",this.toString())}},k=j[c]=[],l=function(){return new j(this)};if(h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return a+="",-1!==i(this,a)},k.add=function(){var a,b=arguments,c=0,d=b.length,e=!1;do a=b[c]+"",-1===i(this,a)&&(this.push(a),e=!0);while(++c<d);e&&this._updateClassName()},k.remove=function(){var a,b=arguments,c=0,d=b.length,e=!1;do{a=b[c]+"";var f=i(this,a);-1!==f&&(this.splice(f,1),e=!0)}while(++c<d);e&&this._updateClassName()},k.toggle=function(a,b){a+="";var c=this.contains(a),d=c?b!==!0&&"remove":b!==!1&&"add";return d&&this[d](a),!c},k.toString=function(){return this.join(" ")},e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(n){-2146823252===n.number&&(m.enumerable=!1,e.defineProperty(d,b,m))}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}}(self);var MicroEvent=function(){};MicroEvent.prototype={bind:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},unbind:function(a,b){this._events=this._events||{},a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},MicroEvent.mixin=function(a){for(var b=["bind","unbind","trigger"],c=0;c<b.length;c++)"function"==typeof a?a.prototype[b[c]]=MicroEvent.prototype[b[c]]:a[b[c]]=MicroEvent.prototype[b[c]]},"undefined"!=typeof module&&"exports"in module&&(module.exports=MicroEvent);var reMarked=function(a){function b(a,b){if(!b)return a;for(var c in a)"undefined"!=typeof b[c]&&(a[c]=b[c])}function c(a,b){for(var c="";b-->0;)c+=a;return c}function d(a){for(var a=a.replace(/^\s\s*/,""),b=/\s/,c=a.length;b.test(a.charAt(--c)););return a.slice(0,c+1)}function e(a){return a?"<"+a+">":""}function f(a){return a?"</"+a+">":""}function g(a,b){return a.replace(/^/gm,b)}function h(a){return("#text"==a.nodeName?"txt":a.nodeName).toLowerCase()}function i(a,b){var c,d;return b instanceof Array?(c=b[0],d=b[1]):c=d=b,c=c instanceof Function?c.call(this,a):c,d=d instanceof Function?d.call(this,a):d,c+a+d}var j=[],k={link_list:!1,h1_setext:!0,h2_setext:!0,h_atx_suf:!1,gfm_code:!1,li_bullet:"*-+"[0],hr_char:"-_*"[0],indnt_str:["    ","  ","  "][0],bold_char:"*_"[0],emph_char:"*_"[1],gfm_del:!0,gfm_tbls:!0,tbl_edges:!1,hash_lnks:!1,br_only:!1};b(k,a),this.render=function(a){if("string"==typeof a){var b=a;a=document.createElement("div"),a.innerHTML=b}var d=new l.tag(a,null,0),e=d.rend().replace(/^[\t ]+\n/gm,"\n");if(k.link_list){e+="\n\n";var f=0;for(var g in j)if(j[g].e.title){var h=j[g].e.href.length;h&&h>f&&(f=h)}for(var i in j){var m=j[i].e.title?c(" ",f+2-j[i].e.href.length)+'"'+j[i].e.title+'"':"";e+="  ["+(+i+1)+"]: "+j[i].e.href+m+"\n"}}return e.replace(/^[\t ]+\n/gm,"\n")};var l={};l.tag=klass({wrap:"",lnPfx:"",lnInd:0,init:function(a,b,c){this.e=a,this.p=b,this.i=c,this.c=[],this.tag=h(a),this.initK()},initK:function(){var a;if(this.e.hasChildNodes()){var b,c,d=/^(?:a|strong|code|em|sub|sup|del|i|u|b|big|center)$/;for(a in this.e.childNodes)if(/\d+/.test(a)&&(b=this.e.childNodes[a],c=h(b),!/style|script|canvas|video|audio/.test(c))){if("txt"==c&&/^\s+$/.test(b.textContent)){if(0==a||a==this.e.childNodes.length-1)continue;var e=this.e.childNodes[a-1],f=this.e.childNodes[a+1];if(e&&!h(e).match(d)||f&&!h(f).match(d))continue}l[c]||(c="tag");var g=new l[c](b,this,this.c.length);(g instanceof l.a&&b.href||g instanceof l.img)&&(g.lnkid=j.length,j.push(g)),this.c.push(g)}}},rend:function(){return this.rendK().replace(/\n{3,}/gm,"\n\n")},rendK:function(){var a,b="";for(var c in this.c)a=this.c[c],b+=(a.bef||"")+a.rend()+(a.aft||"");return b.replace(/^\n+|\n+$/,"")}}),l.blk=l.tag.extend({wrap:["\n\n",""],wrapK:null,tagr:!1,lnInd:null,init:function(a,b,c){this.supr(a,b,c),null===this.lnInd&&(this.lnInd=this.p&&this.tagr&&this.c[0]instanceof l.blk?4:0),null===this.wrapK&&(this.wrapK=this.tagr&&this.c[0]instanceof l.blk?"\n":"")},rend:function(){return i.call(this,(this.tagr?e(this.tag):"")+i.call(this,g(g(this.rendK(),this.lnPfx),c(" ",this.lnInd)),this.wrapK)+(this.tagr?f(this.tag):""),this.wrap)},rendK:function(){var a=this.supr();if(this.p instanceof l.li){var b=null,c=a.match(/^[\t ]+/gm);if(!c)return a;for(var d in c)(null===b||c[d][0].length<b.length)&&(b=c[d][0]);return a.replace(new RegExp("^"+b),"")}return a}}),l.tblk=l.blk.extend({tagr:!0}),l.cblk=l.blk.extend({wrap:["\n",""]}),l.ctblk=l.cblk.extend({tagr:!0}),l.inl=l.tag.extend({rend:function(){return i.call(this,this.rendK(),this.wrap)}}),l.tinl=l.inl.extend({tagr:!0,rend:function(){return e(this.tag)+i.call(this,this.rendK(),this.wrap)+f(this.tag)}}),l.p=l.blk.extend({rendK:function(){return this.supr().replace(/^\s+/gm,"")}}),l.div=l.p.extend(),l.span=l.inl.extend(),l.list=l.blk.extend({expn:!1,wrap:[function(){return this.p instanceof l.li?"\n":"\n\n"},""]}),l.ul=l.list.extend({}),l.ol=l.list.extend({}),l.li=l.cblk.extend({wrap:["\n",function(a){return this.p.expn||a.match(/\n{2}/gm)?"\n":""}],wrapK:[function(){return"ul"==this.p.tag?k.li_bullet+" ":this.i+1+".  "},""],rendK:function(){return this.supr().replace(/\n([^\n])/gm,"\n"+k.indnt_str+"$1")}}),l.hr=l.blk.extend({wrap:["\n\n",c(k.hr_char,3)]}),l.h=l.blk.extend({}),l.h_setext=l.h.extend({}),k.h1_setext&&(l.h1=l.h_setext.extend({wrapK:["",function(a){return"\n"+c("=",a.length)}]})),k.h2_setext&&(l.h2=l.h_setext.extend({wrapK:["",function(a){return"\n"+c("-",a.length)}]})),l.h_atx=l.h.extend({wrapK:[function(){return c("#",this.tag[1])+" "},function(){return k.h_atx_suf?" "+c("#",this.tag[1]):""}]}),!k.h1_setext&&(l.h1=l.h_atx.extend({})),!k.h2_setext&&(l.h2=l.h_atx.extend({})),l.h3=l.h_atx.extend({}),l.h4=l.h_atx.extend({}),l.h5=l.h_atx.extend({}),l.h6=l.h_atx.extend({}),l.a=l.inl.extend({lnkid:null,rend:function(){var a=this.rendK(),b=this.e.getAttribute("href"),c=this.e.title?' "'+this.e.title+'"':"";return!b||b==a||"#"==b[0]&&!k.hash_lnks?a:k.link_list?"["+a+"] ["+(this.lnkid+1)+"]":"["+a+"]("+b+c+")"}}),l.img=l.inl.extend({lnkid:null,rend:function(){var a=this.e.alt,b=this.e.getAttribute("src");if(k.link_list)return"["+a+"] ["+(this.lnkid+1)+"]";var c=this.e.title?' "'+this.e.title+'"':"";return"!["+a+"]("+b+c+")"}}),l.em=l.inl.extend({wrap:k.emph_char}),l.i=l.em.extend(),l.del=k.gfm_del?l.inl.extend({wrap:"~~"}):l.tinl.extend(),l.br=l.inl.extend({wrap:["",function(){var a=k.br_only?"<br>":"  ";return this.p instanceof l.h?"<br>":a+"\n"}]}),l.strong=l.inl.extend({wrap:c(k.bold_char,2)}),l.b=l.strong.extend(),l.dl=l.tblk.extend({lnInd:2}),l.dt=l.ctblk.extend(),l.dd=l.ctblk.extend(),l.sub=l.tinl.extend(),l.sup=l.tinl.extend(),l.blockquote=l.blk.extend({lnPfx:"> ",rend:function(){return this.supr().replace(/>[ \t]$/gm,">")}}),l.pre=l.blk.extend({tagr:!0,wrapK:"\n",lnInd:0}),l.code=l.blk.extend({tagr:!1,wrap:"",wrapK:function(a){return-1!==a.indexOf("`")?"``":"`"},lnInd:0,init:function(a,b,c){if(this.supr(a,b,c),this.p instanceof l.pre)if(this.p.tagr=!1,k.gfm_code){var d=this.e.getAttribute("class");d=(d||"").split(" ")[0],0===d.indexOf("lang-")&&(d=d.substr(5)),this.wrapK=["```"+d+"\n","\n```"]}else this.wrapK="",this.p.lnInd=4}}),l.table=k.gfm_tbls?l.blk.extend({cols:[],init:function(a,b,c){this.supr(a,b,c),this.cols=[]},rend:function(){for(var a in this.c)for(var b in this.c[a].c)for(var c in this.c[a].c[b].c)this.c[a].c[b].c[c].prep();return this.supr()}}):l.tblk.extend(),l.thead=k.gfm_tbls?l.cblk.extend({wrap:["\n",function(){var a="";for(var b in this.p.cols){var e=this.p.cols[b],f="c"==e.a[0]?":":" ",g="r"==e.a[0]||"c"==e.a[0]?":":" ";a+=(0==b&&k.tbl_edges?"|":"")+f+c("-",e.w)+g+(b<this.p.cols.length-1||k.tbl_edges?"|":"")}return"\n"+d(a)}]}):l.ctblk.extend(),l.tbody=k.gfm_tbls?l.cblk.extend():l.ctblk.extend(),l.tfoot=k.gfm_tbls?l.cblk.extend():l.ctblk.extend(),l.tr=k.gfm_tbls?l.cblk.extend({wrapK:[k.tbl_edges?"| ":"",k.tbl_edges?" |":""]}):l.ctblk.extend(),l.th=k.gfm_tbls?l.inl.extend({guts:null,wrap:[function(){var a,b=this.p.p.p.cols[this.i],d=0==this.i?"":" ",e=b.w-this.guts.length;switch(b.a[0]){case"r":a=c(" ",e);break;case"c":a=c(" ",Math.floor(e/2));break;default:a=""}return d+a},function(){var a,b=this.p.p.p.cols[this.i],d=this.i==this.p.c.length-1?"":" |",e=b.w-this.guts.length;switch(b.a[0]){case"r":a="";break;case"c":a=c(" ",Math.ceil(e/2));break;default:a=c(" ",e)}return a+d}],prep:function(){this.guts=this.rendK(),this.rendK=function(){return this.guts};var a=this.p.p.p.cols;a[this.i]||(a[this.i]={w:null,a:""});var b=a[this.i];b.w=Math.max(b.w||0,this.guts.length),this.e.align&&(b.a=this.e.align)}}):l.ctblk.extend(),l.td=l.th.extend(),l.txt=l.inl.extend({initK:function(){this.c=this.e.textContent.split(/^/gm)},rendK:function(){var a=this.c.join("").replace(/\r/gm,"");return this.p instanceof l.code||this.p instanceof l.pre||(a=a.replace(/^\s*#/gm,"\\#").replace(/\*/gm,"\\*")),0==this.i&&(a=a.replace(/^\n+/,"")),this.i==this.p.c.length-1&&(a=a.replace(/\n+$/,"")),a}})};!function(a,b){"function"==typeof define?define(b):"undefined"!=typeof module?module.exports=b():this[a]=b()}("klass",function(){function a(a){return e.call(b(a)?a:function(){},a,1)}function b(a){return typeof a===h}function c(a,b,c){return function(){var d=this.supr;this.supr=c[j][a];var e=b.apply(this,arguments);return this.supr=d,e}}function d(a,d,e){for(var f in d)d.hasOwnProperty(f)&&(a[f]=b(d[f])&&b(e[j][f])&&i.test(d[f])?c(f,d[f],e):d[f])}function e(a,c){function e(){}function f(){this.init?this.init.apply(this,arguments):(c||i&&g.apply(this,arguments),k.apply(this,arguments))}e[j]=this[j];var g=this,h=new e,i=b(a),k=i?a:this,l=i?{}:a;return f.methods=function(a){return d(h,a,g),f[j]=h,this},f.methods.call(f,l).prototype.constructor=f,f.extend=arguments.callee,f[j].implement=f.statics=function(a,b){return a="string"==typeof a?function(){var c={};return c[a]=b,c}():a,d(this,a,g),this},f}var f=this,g=f.klass,h="function",i=/xyz/.test(function(){})?/\bsupr\b/:/.*/,j="prototype";return a.noConflict=function(){return f.klass=g,this},f.klass=a,a}),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports={inlineEls:["span","br","b","strong","em","i","a"],blockEls:["p","h1","h2","h3","blockquote","ul","ol"],allowedHeaderParents:["p","div","h1","h3","h2","h4"],disallowedBlockquoteChildren:["ul","ol","li"]}},{}],2:[function(a,b){b.exports={formatting:"Markdown",mode:"regular",placeholder:"Content here",hooliganismDisabled:!0,positioning:null,painters:{Link:{className:"fa fa-link",enabled:!0},Headings:{className:"fa fa-font headings",enabled:!0,levels:[1,2,3]},Bold:{className:"fa fa-bold",enabled:!0},Italic:{className:"fa fa-italic",enabled:!0},UnorderedList:{className:"fa fa-list-ul",enabled:!0},OrderedList:{className:"fa fa-list-ol",enabled:!0},Blockquote:{className:"fa fa-quote-right",enabled:!0}},shortcutsEnabled:!0,shortcuts:[{key:"ctrl + b",command:"Bold"},{key:"ctrl + i",command:"Italic"},{key:"ctrl + q",command:"Blockquote"},{key:"ctrl + h",command:"H1"},{key:"ctrl + s",command:"H2"}]}},{}],3:[function(a,b){var c=a("./constants"),d={stringStartsWith:function(a,b){return 0===a.indexOf(b)?!0:!1},merge:function(){for(var a,b={},c=0,d=arguments.length;d>c;c++)for(a in arguments[c])arguments[c].hasOwnProperty(a)&&(b[a]=arguments[c][a]);return b}},e={insertAfter:function(a,b){var c=b.parentNode;c.lastchild===b?c.appendChild(a):c.insertBefore(a,b.nextSibling)},offset:function(a){var b=0,c=0;if(a.offsetParent)do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:c}},isAParent:function(a,b){for(var c;c=a.parentNode;){if(c===b)return!0;a=c}return!1},getFirstNonTextParent:function(a){return 3===a.nodeType?a.parentNode:1===a.nodeType?a:void 0},containsEl:function(a,b){var c=!1;return Array.prototype.forEach.call(a,function(a){this.isEl(a,b)&&(c=!0)}.bind(this)),c},isEl:function(a,b){return-1!==b.indexOf(a.nodeName.toLowerCase())?!0:!1},getBlockParent:function(a){var b=c.inlineEls;return 3===a.nodeType?e.getBlockParent(a.parentNode):1===a.nodeType&&-1!==b.indexOf(a.nodeName.toLowerCase())?e.getBlockParent(a.parentNode):1===a.nodeType&&-1===b.indexOf(a.nodeName.toLowerCase())?a:void 0},elIsWithinEl:function(a,b,c){for(;a;){if(a===c)return!1;if(1===a.nodeType&&a.tagName.toLowerCase()===b)return!0;a=a.parentNode}return!1},hasParent:function(a,b){return-1!==b.indexOf(a.parentNode.nodeName.toLowerCase())?!0:!1},unwrap:function(a){for(;a[0];){for(var b=a[0].parentNode;a[0].firstChild;)b.insertBefore(a[0].firstChild,a[0]);b.removeChild(a[0]),a.shift()}},outerHeight:function(a){var b=a.offsetHeight;return b},outerWidth:function(a){var b=a.offsetWidth;return b}};b.exports={Utils:d,DOM:e}},{"./constants":1}],4:[function(a,b){"use strict";function c(a,b){this.forger=a,this.el=b,this.options=a.options,this.addEventListeners(),this.state={}}var d=a("./logger"),e=a("./range_and_selection"),f=a("./dom").DOM;c.prototype={init:function(){this.el.classList.add(this.forger.baseClass),this.el.classList.add("forger"),this.el.setAttribute("contentEditable",!0),this.checkIfEmpty(null,!0)},isEmpty:function(a){var b=this.el.innerHTML.trim();b=b.replace(/<br>/i,"");var c=b.replace(/<(?:.|\n)*?>/gm,"");return""===b||""===c?(a&&a.preventDefault(),!0):!1},checkIfEmpty:function(a){if(this.isEmpty(a)){var b=document.createElement("p"),c=document.createTextNode(this.options.placeholderText);b.appendChild(c),this.el.html(b),this.refocus(c,c.textContent.length)}this.checkIfEmpty=function(a){if(this.isEmpty(a)){var b=document.createElement("p");b.innerHTML="&#8203;",this.el.appendChild(b),this.refocus(b,0)}}},refocus:function(a,b){var c=document.createRange();c.setStart(a,b||0),c.collapse(!0),(new e).addRange(c),this.el.focus()},getSelection:function(a){var b=(new e).selection;f.isAParent(b.anchorNode,this.el)?window.setTimeout(function(){a(b.isCollapsed?!1:b)},0):a(!1)},addEvent:function(a,b,c){this.events||(this.events=[]),a.addEventListener(b,c),this.events.push({el:a,ev:b,handler:c})},removeAllEvents:function(){this.events.forEach(function(a){a.el.removeEventListener(a.ev,a.handler)})},addEventListeners:function(){this.onPaste=this.onPaste.bind(this),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onDocumentMousedown=this.onDocumentMousedown.bind(this),this.onMousedown=this.onMousedown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.addEvent(this.el,"paste",this.onPaste),this.addEvent(this.el,"keyup",this.onKeyUp),this.addEvent(this.el,"keydown",this.onKeyDown),"inline"!==this.options.mode&&(this.addEvent(window,"resize",this.onWindowResize),this.addEvent(this.el,"focus",this.onFocus),this.addEvent(this.el,"blur",this.onBlur),this.addEvent(document,"mousedown",this.onDocumentMousedown),this.addEvent(this.el,"mousedown",this.onMousedown),this.addEvent(this.el,"mouseup",this.onMouseUp))},onFocus:function(){if(d("Editor: onFocus"),this.el.textContent.trim()===this.options.placeholder){var a=document.createElement("p");a.innerHTML="&#8203;",this.el.html(a),this.refocus(a,0)}},onBlur:function(){if(d("Editor: onBlur"),!this.el.textContent.trim()){var a=document.createElement("p"),b=document.createTextNode(this.options.placeholder);a.appendChild(b),this.element.html(a)}},onDocumentMousedown:function(a){f.isAParent(a.target,this.el)||f.isAParent(a.target,this.forger.toolbar.el)||this.reset()},reset:function(){this.forger.toolbar.hide(),this.forger.enterFormattingMode()},onMousedown:function(a){a.stopPropagation(),this.state.lastMouseDownOffsets={x:a.pageX,y:a.pageY}},onMouseUp:function(){d("Editor: Mouseup"),this.getSelection(function(a){a&&this.forger.toolbar.isHidden?(this.forger.toolbar.positionEl(this.state.lastMouseDownOffsets),this.forger.toolbar.show()):a&&!this.forger.toolbar.isHidden?this.forger.toolbar.positionEl(this.state.lastMouseDownOffsets):a||"link"===this.forger.uiMode||this.reset()}.bind(this))},onKeyDown:function(a){if(13===a.keyCode&&"inline"===this.options.mode)return a.preventDefault(),!1;if(this.options.hooliganismDisabled){var b=f.getFirstNonTextParent((new e).getRange().startContainer);13!==a.keyCode||b.textContent.trim()||"li"===b.nodeName.toLowerCase()||a.preventDefault()}},onKeyUp:function(a){this.checkIfEmpty(a)},onPaste:function(a){a.preventDefault();var b;if(a.clipboardData){b=a.clipboardData.getData("text/plain");{a.clipboardData.getData("text/html")}}else if(window.clipboardData){b=window.clipboardData.getData("Text");{window.clipboardData.getData("URL")}}b=b.replace(/\n/g," "),document.execCommand("insertHTML",!1,b)},onWindowResize:function(){d("Editor: Handling resize"),this.forger.toolbar.positionEl(this.state.lastMouseDownOffsets)},getContent:function(){return this.el.innerHTML.trim()}},b.exports=c},{"./dom":3,"./logger":8,"./range_and_selection":24}],5:[function(a,b){"use strict";var c=a("./shortcut_manager"),d=a("./formatter"),e=a("./editor"),f=a("./sanitiser"),g=a("./toolbar"),h=a("./painters"),i=a("./dom").Utils,j=a("./defaults"),k=function(){var a=0;return function(){return a++}}(),l=function(a,b){return this.options=i.merge(j,b),this.id=k(),this.el=a,this.baseClass="forger-"+this.id,this.init(),this};l.prototype={init:function(){return this.editor=new e(this,this.el),this.editor.init(),this.shortcutManager=new c(this,this.options.shortcuts),this.formatter=new d,this.sanitiser=new f,this.setupPainters(),"inline"!==this.options.mode&&(this.toolbar=new g(this,this.baseClass),this.enterFormattingMode()),this},setupPainters:function(){this.painters=[];for(var a in this.options.painters)if(this.options.painters[a].enabled){var b=new h[a](this);this.painters.push(b)}},enterLinkMode:function(){this.toolbar.enterLinkMode()},enterFormattingMode:function(){this.toolbar.enterFormattingMode()},markdown:function(){return(new d).getMarkdown(new f(this.editor.getContent()).sanitise())},HTML:function(){return new f(this.editor.getContent()).sanitise()},use:function(a){var b=l.Plugins.cache[a];if(!b)throw new Error("There is no plugin registered with that name, use Forger.Plugins.register('name', fn) to register a plugin");b(this)},destroy:function(){this.editor.el.attr("contentEditable","inherit")}},l.DEBUG=!0,b.exports=l},{"./defaults":2,"./dom":3,"./editor":4,"./formatter":6,"./painters":16,"./sanitiser":25,"./shortcut_manager":26,"./toolbar":27}],6:[function(a,b){function c(){}c.prototype={getMarkdown:function(a){return new reMarked({h_atx_suf:!0}).render(a)}},b.exports=c},{}],7:[function(a,b){var c=a("./forger");b.exports=function(){window.$&&($.fn.Forger=function(a){return this.each(function(){var b=$(this),d=b.data("Forger");d||b.data("Forger",d=new c(this,a)),"string"==typeof a&&d[a]()})},$.fn.Forger.Constructor=c)}},{"./forger":5}],8:[function(a,b){function c(a){d.DEBUG&&console.log(a)}var d=a("./forger");b.exports=c},{"./forger":5}],9:[function(a){var b=a("./forger");a("./jquery_wrapper")(),a("./plugins"),window.Forger=b},{"./forger":5,"./jquery_wrapper":7,"./plugins":22}],10:[function(a,b){var c=(a("../logger"),a("../range_and_selection")),d=a("../dom").DOM,e=a("../constants"),f=function(){var a=(new c).getNodesInRange(),b=!d.containsEl(a,e.disallowedBlockquoteChildren);return b},g=function(a){this.enabled=!0,this.forger=a,this.name="Blockquote",this.className=a.options.painters[this.name].className};g.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},canApply:function(){return f()},apply:function(){if(this.canApply()){var a=(new c).getNodesInRange(!0);if(d.containsEl(a,"blockquote"))if(window.opera)document.execCommand("formatBlock",!1,"<p>"),document.execCommand("outdent"),this.trigger("formatting:applied");else{for(var b=(new c).getRangeData(),e=[],f=a.length-1;f>=0;f--)"blockquote"===a[f].nodeName.toLowerCase()&&e.push(a[f]);d.unwrap(e),setTimeout(function(){(new c).createRangeFromData(b,!0),this.forger.toolbar.positionEl(),this.trigger("formatting:applied")}.bind(this),1)}else window.opera?(document.execCommand("formatBlock",!1,"<blockquote>"),this.trigger("formatting:applied")):(document.execCommand("indent"),this.trigger("formatting:applied"))}},assignActiveState:function(){var a=(new c).getRange().startContainer,b=d.elIsWithinEl(a,"blockquote",this.forger.editor.el.parentNode)?!0:!1;b?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(g),b.exports=g},{"../constants":1,"../dom":3,"../logger":8,"../range_and_selection":24}],11:[function(a,b){var c=(a("../logger"),a("../range_and_selection"),a("../dom").DOM,function(a){this.enabled=!0,this.forger=a,this.name="Bold",this.className=a.options.painters[this.name].className});c.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},apply:function(){console.log("Painter: Bold: Applying"),document.execCommand("bold"),this.trigger("formatting:applied")},assignActiveState:function(){var a=document.queryCommandState("bold");a?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(c),b.exports=c},{"../dom":3,"../logger":8,"../range_and_selection":24}],12:[function(a,b){var c=(a("../logger"),a("../range_and_selection")),d=a("../dom").DOM,e=function(){var a=TextUtils.getCurrentRange(),b=Constants.allowedHeaderParents,c=getNodesInRange();if(d.getBlockParent(a.startContainer)===d.getBlockParent(a.endContainer)&&!d.containsEl(c,["br"])){var e=d.getBlockParent(a.startContainer);if(-1!==b.indexOf(e.nodeName.toLowerCase()))return!0}return!1},f=function(a){this.enabled=!0,this.forger=a,this.name="H1",this.className=a.options.painters[this.name].className};f.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},canApply:function(){return e()},apply:function(){this.canApply()&&(d.isEl(d.getBlockParent((new c).getRange().startContainer),["p","div"])?document.execCommand("formatBlock",!1,"<h1>"):document.execCommand("formatBlock",!1,"<p>")),this.trigger("formatting:applied")},assignActiveState:function(){var a=(new c).getRange().startContainer,b=d.elIsWithinEl(a,"h1",this.forger.editor.el.parentNode)?!0:!1;b?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(f),b.exports=f},{"../dom":3,"../logger":8,"../range_and_selection":24}],13:[function(a,b){var c=(a("../logger"),a("../range_and_selection")),d=a("../dom").DOM,e=function(){var a=TextUtils.getCurrentRange(),b=Constants.allowedHeaderParents,c=getNodesInRange();if(d.getBlockParent(a.startContainer)===d.getBlockParent(a.endContainer)&&!d.containsEl(c,["br"])){var e=d.getBlockParent(a.startContainer);if(-1!==b.indexOf(e.nodeName.toLowerCase()))return!0}return!1},f=function(a){this.enabled=!0,this.forger=a,this.name="H2",this.className=a.options.painters[this.name].className};f.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},canApply:function(){return e()},apply:function(){this.canApply()&&(d.isEl(d.getBlockParent((new c).getRange().startContainer),["p","div"])?document.execCommand("formatBlock",!1,"<h2>"):document.execCommand("formatBlock",!1,"<p>")),this.trigger("formatting:applied")},assignActiveState:function(){var a=(new c).getRange().startContainer,b=d.elIsWithinEl(a,"h2",this.forger.editor.el.parentNode)?!0:!1;b?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(f),b.exports=f},{"../dom":3,"../logger":8,"../range_and_selection":24}],14:[function(a,b){var c=(a("../logger"),a("../range_and_selection")),d=a("../dom").DOM,e=function(){var a=TextUtils.getCurrentRange(),b=Constants.allowedHeaderParents,c=getNodesInRange();if(d.getBlockParent(a.startContainer)===d.getBlockParent(a.endContainer)&&!d.containsEl(c,["br"])){var e=d.getBlockParent(a.startContainer);if(-1!==b.indexOf(e.nodeName.toLowerCase()))return!0}return!1},f=function(a){this.enabled=!0,this.forger=a,this.name="H3",this.className=a.options.painters[this.name].className};f.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},canApply:function(){return e()},apply:function(){this.canApply()&&(d.isEl(d.getBlockParent((new c).getRange().startContainer),["p","div"])?document.execCommand("formatBlock",!1,"<h3>"):document.execCommand("formatBlock",!1,"<p>")),this.trigger("formatting:applied")},assignActiveState:function(){var a=(new c).getRange().startContainer,b=d.elIsWithinEl(a,"h3",this.forger.editor.el.parentNode)?!0:!1;b?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(f),b.exports=f},{"../dom":3,"../logger":8,"../range_and_selection":24}],15:[function(a,b){var c=(a("../logger"),a("../range_and_selection")),d=a("../dom").DOM,e=a("../constants"),f=function(){var a=(new c).getRange(),b=e.allowedHeaderParents,f=(new c).getNodesInRange();if(d.getBlockParent(a.startContainer)===d.getBlockParent(a.endContainer)&&!d.containsEl(f,["br"])){var g=d.getBlockParent(a.startContainer);if(-1!==b.indexOf(g.nodeName.toLowerCase()))return!0}return!1},g=function(a){this.enabled=!0,this.forger=a,this.name="Headings",this.className=a.options.painters[this.name].className,this.levelMenuOpen=!1};g.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");b.className=this.className,a.appendChild(b);var c=document.createElement("ul");return c.className="heading-levels",c.style.display="none",this.forger.options.painters[this.name].levels.forEach(function(a){var b=document.createElement("li");b.textContent="H"+a,b.setAttribute("data-heading-level",a),c.appendChild(b)}),a.appendChild(c),this.button=a,this.levelMenu=c,setTimeout(function(){this.addEventListeners()}.bind(this),1),this.button},addEventListeners:function(){var a=this.button.querySelector(".heading-levels");a.addEventListener("mousedown",function(a){if(a.target&&"li"===a.target.nodeName.toLowerCase()){var b=a.target.getAttribute("data-heading-level");a.stopPropagation();var d=new c;d.restoreSelection(d.selection,d.getRange(),function(){this.applyLevelFormatting(b)}.bind(this))}}.bind(this))},canApply:function(){return f()},showLevelMenu:function(){this.levelMenu.style.display="block",this.levelMenuOpen=!0},hideLevelMenu:function(){this.levelMenu.style.display="none",this.levelMenuOpen=!1},apply:function(){this.levelMenuOpen?this.hideLevelMenu():this.showLevelMenu()},applyLevelFormatting:function(a){this.canApply()&&(d.isEl(d.getBlockParent((new c).getRange().startContainer),["p","div"])?document.execCommand("formatBlock",!1,"<h"+a+">"):document.execCommand("formatBlock",!1,"<p>"),this.hideLevelMenu()),this.trigger("formatting:applied")},assignActiveState:function(){var a=(new c).getRange().startContainer,b=d.elIsWithinEl(a,"h1",this.forger.editor.el.parentNode)||d.elIsWithinEl(a,"h2",this.forger.editor.el.parentNode)||d.elIsWithinEl(a,"h3",this.forger.editor.el.parentNode);b?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(g),b.exports=g},{"../constants":1,"../dom":3,"../logger":8,"../range_and_selection":24}],16:[function(a,b){var c={Blockquote:a("./blockquote"),Bold:a("./bold"),Headings:a("./headings"),H1:a("./h1"),H2:a("./h2"),H3:a("./h3"),Italic:a("./italic"),Link:a("./link"),OrderedList:a("./ordered_list"),UnorderedList:a("./unordered_list")};b.exports=c},{"./blockquote":10,"./bold":11,"./h1":12,"./h2":13,"./h3":14,"./headings":15,"./italic":17,"./link":18,"./ordered_list":19,"./unordered_list":20}],17:[function(a,b){var c=(a("../logger"),a("../range_and_selection"),a("../dom").DOM,function(a){this.enabled=!0,this.forger=a,this.name="Italic",this.className=a.options.painters[this.name].className});c.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},apply:function(){document.execCommand("italic"),this.trigger("formatting:applied")},assignActiveState:function(){var a=document.queryCommandState("italic");a?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(c),b.exports=c},{"../dom":3,"../logger":8,"../range_and_selection":24}],18:[function(a,b){var c=a("../logger"),d=a("../range_and_selection"),e=a("../dom").DOM,f=a("../dom").Utils,g=function(a){this.enabled=!0,this.forger=a,this.name="Link",this.className=a.options.painters[this.name].className,this.selectionBeforeInput=null,this.state={}};g.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,setTimeout(function(){this.addEventListeners()}.bind(this),1),this.button},addEvent:function(a,b,c){this.events||(this.events=[]),a.addEventListener(b,c),this.events.push({el:a,ev:b,handler:c})},removeAllEvents:function(){this.events.forEach(function(a){a.el.removeEventListener(a.ev,a.handler)})},addEventListeners:function(){"inline"!==this.forger.options.mode&&(this.onLinkInputBlur=this.onLinkInputBlur.bind(this),this.onAddLinkMousedown=this.onAddLinkMousedown.bind(this),this.addEvent(this.forger.toolbar.el.querySelector(".link input"),"blur",this.onLinkInputBlur),this.addEvent(this.forger.toolbar.el.querySelector(".js-add-link"),"mousedown",this.onAddLinkMousedown))},onLinkInputBlur:function(){c("Painter: Link: onLinkInputBlur"),this.state.handlingLinkAdd?this.state.handlingLinkAdd=!1:(this.forger.enterFormattingMode(),setTimeout(function(){(new d).addRange(this.selectionBeforeInput)}.bind(this),10))},onAddLinkMousedown:function(){c("Painter: Link: onAddLinkMousedown"),this.state.handlingLinkAdd=!0,this.handleUrlSubmission()},apply:function(){c("Painter: Link: Applying"),this.selectionBeforeInput=(new d).getRange();var a=(new d).getRange(),b=e.getFirstNonTextParent(a.startContainer),f=e.getFirstNonTextParent(a.endContainer),g=null;"a"===b.nodeName.toLowerCase()?g=b.href:"a"===f.nodeName.toLowerCase()&&(g=f.href),this.forger.toolbar.setLinkPlaceholder(g),this.forger.enterLinkMode()},handleUrlSubmission:function(){c("Painter: Link: Handling URL submission"),(new d).addRange(this.selectionBeforeInput);var a=this.forger.toolbar.el.querySelector(".link").querySelector("input").value.trim();a&&this.applyLinkToDOM(a),this.forger.enterFormattingMode(),setTimeout(function(){if(a){var b=e.getFirstNonTextParent(this.selectionBeforeInput.startContainer),c=b.querySelectorAll("a")[0],f=document.createRange();
f.selectNode(c)}else var f=this.selectionBeforeInput;(new d).addRange(f)}.bind(this),10)},applyLinkToDOM:function(a){f.stringStartsWith(a,"http://")||f.stringStartsWith(a,"https://")||(a="http://"+a),document.execCommand("createLink",!1,a),this.trigger("formatting:applied")},assignActiveState:function(){var a=document.queryCommandState("link");a?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(g),b.exports=g},{"../dom":3,"../logger":8,"../range_and_selection":24}],19:[function(a,b){var c=(a("../logger"),a("../range_and_selection"),a("../dom").DOM,function(a){this.enabled=!0,this.forger=a,this.name="OrderedList",this.className=a.options.painters[this.name].className});c.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},apply:function(){document.execCommand("insertorderedlist"),this.trigger("formatting:applied")},assignActiveState:function(){var a=document.queryCommandState("insertorderedlist");a?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(c),b.exports=c},{"../dom":3,"../logger":8,"../range_and_selection":24}],20:[function(a,b){var c=(a("../logger"),a("../range_and_selection"),a("../dom").DOM,function(a){this.enabled=!0,this.forger=a,this.name="UnorderedList",this.className=a.options.painters[this.name].className});c.prototype={getDOMButton:function(){var a=document.createElement("li"),b=document.createElement("i");return b.className=this.className,a.appendChild(b),this.button=a,this.button},apply:function(){document.execCommand("insertunorderedlist"),this.trigger("formatting:applied")},assignActiveState:function(){var a=document.queryCommandState("insertunorderedlist");a?this.button.classList.add("active"):this.button.classList.remove("active")}},MicroEvent.mixin(c),b.exports=c},{"../dom":3,"../logger":8,"../range_and_selection":24}],21:[function(a,b){function c(){}b.exports=c},{}],22:[function(a){var b=a("../forger"),c=a("./focus_mode"),d=a("./words");b.Plugins={cache:{},register:function(a,b){this.cache[a]=b}},b.Plugins.register("focusPlugin",c),b.Plugins.register("wordsPlugin",d)},{"../forger":5,"./focus_mode":21,"./words":23}],23:[function(a,b){function c(){}b.exports=c},{}],24:[function(a,b){function c(){this.selection=window.getSelection()}c.prototype={getRange:function(){return this.selection.getRangeAt(0)},getRangeData:function(){var a=this.getRange().cloneRange();return{startContainer:a.startContainer,startOffset:a.startOffset,endContainer:a.endContainer,endOffset:a.endOffset}},createRangeFromData:function(a,b){var c=document.createRange();return c.setStart(a.startContainer,a.startOffset),c.setEnd(a.endContainer,a.endOffset),b&&this.addRange(c),c},addRange:function(a){this.selection.removeAllRanges(),this.selection.addRange(a)},restoreSelection:function(a,b,c){setTimeout(function(){this.addRange(b),c()}.bind(this),0)},rangeIntersectsNode:function(a,b){var c;if(a.intersectsNode)return a.intersectsNode(b);c=b.ownerDocument.createRange();try{c.selectNode(b)}catch(d){c.selectNodeContents(b)}return-1==a.compareBoundaryPoints(Range.END_TO_START,c)&&1==a.compareBoundaryPoints(Range.START_TO_END,c)},getNodesInRange:function(a){var b,c,d,e,f,g=this;if(c=window.getSelection(),c.rangeCount>0&&(b=c.getRangeAt(0)),b)for(f=b.commonAncestorContainer,1!=f.nodeType&&(f=f.parentNode),e=window.document.createTreeWalker(f,NodeFilter.SHOW_ELEMENT,function(a){return g.rangeIntersectsNode(b,a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},!1),d=[e.currentNode];e.nextNode();)d.push(e.currentNode);return a&&1===d.length&&d.push(d[0].parentNode),console.log(d),d}},b.exports=c},{}],25:[function(a,b){"use strict";function c(a){this.html=a}c.prototype={sanitise:function(){var a=this,b=this.html.replace(/&nbsp;/gi," "),c=document.createElement("div");c.innerHTML=b,c.normalize(),this.reorderElements(c,["ul","ol","div","p"],["div","p"]),this.removeMatchingEls(c,"br",!0),this.wrapTextNodes(c);var d=c.querySelectorAll("blockquote");return Array.prototype.forEach.call(d,function(b){a.wrapTextNodes(b)}),this.sanitiseBrElements(c),this.removeEmptyElements(c,"div"),this.removeEmptyElements(c,"p"),this.swapElements(c,"div","p"),c.innerHTML},sanitiseBrElements:function(a){for(var b=a.querySelectorAll("br + br"),c=0,d=b.length;d>c;c++){var e=b[c];e.parentNode.removeChild(e)}},swapElements:function(a,b,c){var d=a.querySelectorAll(b);Array.prototype.forEach.call(d,function(a){var b=document.createElement(c);b.innerHTML=a.innerHTML,a.parentNode.replaceChild(b,a)})},reorderElements:function(a,b,c){this.walkTheDOM(a,function(d){d.parentNode!==a&&d!==a&&DOM.isEl(d,b)&&DOM.hasParent(d,c)&&DOM.unwrap([d])})},removeEmptyElements:function(a,b){for(var c=a.querySelectorAll(b),d=0,e=c.length;e>d;d++)c[d].nodeName.toLowerCase()===b&&""===c[d].innerHTML.trim()&&c[d].parentNode.removeChild(c[d])},walkTheDOM:function(a,b){for(b(a),a=a.firstChild;a;)this.walkTheDOM(a,b),a=a.nextSibling},removeMatchingEls:function(a,b,c){for(var d=a.querySelectorAll(b),e=0,f=d.length;f>e;e++)c?c&&d[e].parentNode===a&&d[e].parentNode.removeChild(d[e]):d[e].parentNode.removeChild(d[e])},wrapTextNodes:function(a){for(var b=0,c=0,d=a.childNodes.length;d>c;c++)if(3===a.childNodes[c].nodeType){var e=document.createElement("p");a.childNodes[c].parentNode.insertBefore(e,a.childNodes[c]),e.appendChild(a.childNodes[c+1]),b++}return b}},b.exports=c},{}],26:[function(a,b){function c(a,b){this.editor=a.editor,this.mappings=b,this.addEventListeners()}var d={16:"shift",17:"ctrl",66:"b",73:"i",81:"q",72:"h",83:"s"};c.prototype.addEventListeners=function(){function a(a){var c=[];a.ctrlKey&&c.push("ctrl"),d[a.keyCode]&&c.push(d[a.keyCode]);var e=c.join("+");b.processHotkey(e,a)}var b=this;this.editor.el.addEventListener("keydown",a),this.removeEventListeners=function(){this.editor.el.removeEventListener("keydown",a)}},c.prototype.processHotkey=function(a,b){this.mappings.forEach(function(c){c.key===a&&b.preventDefault()})},c.prototype.destroy=function(){this.removeEventListeners()},b.exports=c},{}],27:[function(a,b){"use strict";function c(a){this.forger=a,this.isHidden=!0,this.attrs={},this.mode=a.options.mode,this.painters=a.painters,this.el=this.constructToolbar(),this.state={},document.querySelector("body").appendChild(this.el),this.setInitialState(),this.addEventListeners()}var d=String()+"<div class='formatting'><ul></ul></div><div class='link'><div class='link-wrapper'><input type='text' placeholder='e.g. http://www.reddit.com' /><button class='js-add-link'><i class='fa fa-plus-circle'></i></button></div></div><div class='arrow down'></div>",e=a("./logger"),f=a("./range_and_selection"),g=a("./dom").DOM;c.prototype={addEventListeners:function(){var a=this;this.painters.forEach(function(b){b.bind("formatting:applied",function(){a.positionEl(),a.setActiveFormats()})})},constructToolbar:function(){var a=document.createElement("div");a.className=this.forger.baseClass+"-toolbar forger-toolbar hide cf",a.innerHTML=d;var b=a.querySelector("ul");return this.painters.forEach(function(a){var c=a.getDOMButton();b.appendChild(c),c.addEventListener("mousedown",function(){e("Toolbar: Painter clicked");var b=new f;b.restoreSelection(b.selection,b.getRange(),function(){a.apply()})}.bind(this))}),a.querySelector(".formatting").appendChild(b),a},setInitialState:function(){this.makeQueryable(),this.attrs.toolbarHeight=g.outerHeight(this.el),this.attrs.toolbarWidth=g.outerWidth(this.el),this.attrs.toolbarArrowLeftOffset=parseInt(getComputedStyle(this.el.querySelector(".arrow")).left),this.attrs.toolbarArrowHeight=g.outerHeight(this.el.querySelector(".arrow")),this.returnFromQueryable()},makeQueryable:function(){this.el.classList.add("queryable")},returnFromQueryable:function(){this.el.classList.remove("queryable")},enterFormattingMode:function(){var a=this.el.querySelector(".formatting");a.style.display="block";var b=this.el.querySelector(".link");b.style.display="none"},enterLinkMode:function(){var a=this.el.querySelector(".formatting");a.style.display="none";var b=this.el.querySelector(".link");b.style.display="block",b.querySelector("input").focus()},positionEl:function(){var a=(new f).getRange(),b=a.getClientRects()[0],c=document.documentElement.scrollTop||document.body.scrollTop,d={sidey:function(){this.el.style.top=b.top+c-this.attrs.toolbarHeight+"px",this.el.style.left=b.left-(this.attrs.toolbarArrowLeftOffset+20)+"px"},top:function(){this.el.style.top=b.top+c-this.attrs.toolbarHeight-this.attrs.toolbarArrowHeight+"px",this.el.style.left=(b.left+b.right)/2-this.attrs.toolbarWidth/2+"px"}};d.top.call(this)},show:function(){e("Toolbar: Showing"),this.isHidden=!1,this.setActiveFormats(),this.el.classList.remove("hide"),this.el.classList.add("show")},hide:function(){e("Toolbar: Hiding"),this.isHidden=!0,this.el.classList.remove("show"),this.el.classList.add("hide")},setActiveFormats:function(){this.painters.forEach(function(a){a.assignActiveState()})},setLinkPlaceholder:function(a){this.el.querySelector(".link").querySelector("input").value=a||""}},b.exports=c},{"./dom":3,"./logger":8,"./range_and_selection":24}]},{},[9]);